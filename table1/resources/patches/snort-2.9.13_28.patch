===== Patch instructions generated by SAVER =====
[+] { Insert: if ({ _FtpTelnetReload:n$53 == { -1 } }) free(*(_FtpTelnetReload:pPolicyConfig)) at 29 (line 549, column 9) }
===== Actual patch in diff format =====
--- a/table1/benchmarks/snort-2.9.13/src/preprocessors/Stream6/snort_stream_tcp.c
+++ b/table1/benchmarks/snort-2.9.13/src/preprocessors/Stream6/snort_stream_tcp.c
@@ -11874,6 +11874,7 @@ void registerPortForReassembly( char *network, uint16_t port, int ra_dir )
 {
     SFIP_RET status;
     SDListItem *net_node;
+    int tmp = 0;
 
     // if network is NULL then this is a registration for the default policy
     if( network == NULL )
@@ -11924,7 +11925,7 @@ void registerPortForReassembly( char *network, uint16_t port, int ra_dir )
                 NetworkReassemblyPorts *new_net = initNetworkPortReassembly( ip, port, ra_dir);
                 if( new_net != NULL)
                 {
-                    sf_sdlist_ins_prev( &targeted_nrps, net_node, new_net );
+                    tmp = sf_sdlist_ins_prev( &targeted_nrps, net_node, new_net );
                     ip = NULL;
                 }
                 break;
@@ -11940,6 +11941,8 @@ void registerPortForReassembly( char *network, uint16_t port, int ra_dir )
         // finished searching list for matching network... if net_node is NULL then we did not
         // find a match AND all networks in the list are 'less than' or more general than the
         // request network...
+        if (tmp == -1)
+            free(new_net);
         if( net_node == NULL )
         {
             // at list end and found no match, add new network to end of list
