===== Patch instructions generated by SAVER =====
[+] { Insert: if (true) free(*(p11_constant_reverse:lookups)) at 27 (line 684, column 11),
        Insert: if ({ p11_constant_reverse:n$19 == { 0 } }) free(*(p11_constant_reverse:lookups->buckets)) at 26 (line 684, column 11) }
===== Actual patch in diff format =====
@@ -683,6 +683,8 @@ p11_constant_reverse (bool nick)
 				for (k = 0; table[j].nicks[k] != NULL; k++) {
 					if (!p11_dict_set (lookups, (void *)table[j].nicks[k],
 					                   (void *)&table[j].value))
+						free(lookups->buckets);
+						free(lookups);
 						return_val_if_reached (NULL);
 				}
 			} else {
